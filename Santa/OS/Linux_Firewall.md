# 防火墙概述

防火墙是保护计算机系统和网络免受未经授权访问和网络攻击的安全机制。Linux 系统中，防火墙通过控制进入和离开网络的数据包，实现网络流量的过滤和管理。

Linux 上的防火墙配置工具有多种，其中最为常用的是 iptables 和现代 firewalld，以及一些其他如 ufw 这样的简化管理工具。

## 基本原理

防火墙的基本工作原理是根据设定的规则对网络数据包进行过滤和处理，规则通常包括以下几部分

源地址：数据包的来源地址，可以是 IP 或网络段。

目标地址：数据包的目的地址。

协议类型：如**TCP、UDP、ICMP**等。

源端口和目标端口：与传输协议相关联的端口号，如 HTTP 服务的 80 端口

防火墙通过链（Chains）和规则（Rules）来定义如何处理数据包：

1. 链（Chains）：防火墙规则的处理路径，通常分为三类：

  - INPUT：进入系统的数据包（例如从外部网络到本地主机）。

  - FORWARD：转发通过本地系统的数据包（例如路由设备的功能）。

  - OUTPUT：从本地系统发送出去的数据包。

2. 规则（Rules）：每个链上可以设置多条规则，定义了如何处理特定的数据包。常见的动作包括：

  - ACCEPT：允许数据包通过。

  - DROP：丢弃数据包，不给出响应。

  - REJECT：拒绝数据包并返回错误信息。

## iptables

  经典的防火墙工具

 iptables 是 Linux 内核中的网络数据包过滤框架，提供了强大的防火墙功能，主要管理 IPv4 的防火墙规则。


iptables 基本语法

 iptables 命令的基本格式如下：

` iptables [选项] 链名 [条件匹配] -j 动作`


## firewalld

现代防火墙管理工具

firewalld 是 iptables 的一个更高级的替代品，提供了动态防火墙管理。它简化了防火墙规则的管理，并支持区域概念，允许根据网络接口或源地址设置不同的防火墙策略。

4.1 firewalld 的基本概念
区域（Zones）：每个网络接口或源地址可以分配到一个区域，区域定义了不同的信任级别。例如，public 区域默认会拒绝大部分的入站流量，而 trusted 区域则允许所有流量。
服务（Services）：firewalld 通过预定义的服务（如 HTTP、SSH）来简化规则管理。服务包含了默认端口、协议的定义，用户可以通过启用或禁用服务来管理网络访问。
即时与永久规则：firewalld 允许即时应用规则（不重启生效），并区分永久规则和即时规则。永久规则在重启系统后依然有效

## ufw

简化的防火墙管理工具

ufw（Uncomplicated Firewall）是 Ubuntu 系统上简化防火墙管理的工具，它是 iptables 的前端工具，旨在提供更加用户友好的命令来管理防火墙。
