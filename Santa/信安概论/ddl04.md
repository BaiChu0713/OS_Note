# 访问控制

## 访问控制概述
一个经过计算机系统识别和验证后的用户（合法用户）进入系统后，并非意味着他具有对系统所有资源的访问权限

- reverse
  - 消息认证：验证消息的**完整性**，接收方能够验证收到的报文是**真实的**和**未被篡改的**

  - 数字签名：通过某种密码运算，生成一系列符号和代码，这些符号与代码组成电子密码进行**签名**，用于**鉴定签名人的身份**，以及**对一项数据内容的认可**

  - 身份认证：验证一个主体身份的真实性，验证被验者是否名副其实（识别用户是谁）

  - 访问控制：访问控制是指**在鉴别用户的合法身份后**，通过某种途径**准许或限制**用户堆数据信息的**访问能力**及范围（管理**用户对资源的访问**）

- 访问控制三要素：

  1. 主体：提出访问请求的实体，动作的发起者（主体可以是用户/进程/设备）

  2. 客体：需要保护的资源（可以被操作的信息，资源，对象等）

  3. 访问策略：主体对客体的访问规则集，限制主体对客体的访问权限，由管理部门or OS自动对比严格的规则来设置

    - 访问控制决策功能ADF：决定是否允许主体对客体进行访问

    - 访问控制执行功能AEF：负责确保主体在可提升只能执行由ADF允许的访问（基于ADF）

授权：规定可对该资源执行的动作（读写/执行/拒绝访问）
未授权的访问：未经授权的使用、泄露、修改、销毁等

- 访问控制的作用
  1. user在系统安全策略下正常工作
  2. 拒绝非法用户的非授权访问请求
  3. 拒绝合法用户越权得到服务请求

## 访问控制策略与机制

### 基于身份的策略

   - 个人策略：根据哪些用户可对哪些目标实施哪一种行为来表示，等价于访问矩阵列
      - **访问矩阵列**：用于个三元组（SOA）来表示，S——主体集合，O——客体集合，A——属性集合

      - **最小特权原则**：要求最大限度地限制每个用户为实施授权任务所需要的许可集合

![photo](/Photos/08.png)
   - 小组策略：一组用户对于一个目标具有相同的访问许可，相当于访问矩阵中多行压缩成一行

      使用方案：

       1. 定义小组成员
       2. 对小组进行授权
       3. 小组成员可以改变

### 基于规则的策略

基于规则的安全策略依赖于敏感性

在一个安全系统中，数据或资源应该标注安全标记

在实际使用时，系统通过比较用户的安全级别和客体资源的安全级别来判断是否允许用户进行访问

安全级别：绝密，秘密，机密，限制，无密级

### 基于角色的策略

基于组的策略的变形，一个角色对应一个组

优点：容易映射到一个**访问矩阵**或**基于组的策略**陈述上

## 访问控制模型

- 三种访问控制模型

  1. 自主访问控制DAC——基于身份的安全策略
  2. 强制访问控制MAC——基于规则的安全策略
  3. 基于角色的访问控制RBAC

### DAC 自主访问控制

  根据**自主访问控制**策略建立的一种模型

  允许**合法用户**或用户组的身份来访问系统控制策略许可的客体，同时**阻止非授权用户访问客体**

  某些用户还可以**自主地**把**自己所拥有的客体访问权限授予其它用户**

  **任何时刻**可将这些权限**回收**

  用户可以针对被保护对象制定自己的保护策略

  eg.朋友圈分享，网盘分享

  - 访问权限信息的形式
    1. 访问控制矩阵ACM

    ![photo](/Photos/09.png)

    2. 访问控制表ACL（一个客体中几个主体有权限）

    从客体的角度进行分析

    ![photo](/Photos/10.png)

    3. 访问控制能力表ACCL（一个主体可以访问什么客体）

    ![photo](/Photos/11.png)

    ![photo](/Photos/12.png)

ACL与ACCL的比较

|类型|保存位置|关注点|
|-|-|-|
|ACL|随客体存放|简介表示每个用户的权限|
|ACCL|保存在主体端|明确表示每个用户的权限|

**自主访问控制优缺点**

|优点|根据主体的身份和访问权限进行决策，灵活性高|
|-|-|
|缺点|安全性不高（eg.特洛伊木马攻击）|

### MAC 强制访问控制

计算机系统根据使用系统的机构事先确定的安全策略，对用户的访问权限进行强制性的控制

系统事先给访问主体和受控客体分配**不同的安全级别属性**，在实施访问控制时，系统先对访问主体和受控客体的**安全级别**属性进行**比较**，再决定访问主体能否访问该客体

- BLP

 策略总结是下读上写，信息只能向高安全等级的方向流动，避免敏感信息的泄露

 下读上写：主体只能读安全等级低于等于自己的，只能写安全等级高于等于自己的客体

 ![photo](/Photos/13.png)

    - BLP仅仅实现了基于安全级别的控制，相同级别的主体有相同的权限，不能很好实现**最小特权原则**，故引入了**范畴**的概念

    - 最小特权原则：对system的访问过程中，主体**仅具有其完成**特定任务**所必须的权限**，此外没有任何其它权限

 ![photo](/Photos/14.png)

  ![photo](/Photos/15.png)

- Biba

BLP关注了信息的保密性**（下读上写）**但是没有保护完整性

Biba强调的是完整性**（下写上读）**，适合商业需求

对于Biba主体，程序的完整性等级越高，可靠性越高

对于Biba客体，高等级的数据比低等级的数据具有更高的精确性和可靠性

![photo](/Photos/16.png)

**自主访问控制优缺点**

|自主访问控制||
|-|-|
|优点|保证信息的**单向流动**，防止特洛伊木马攻击；具有安全属性的访问控制，适用于**严格管理层级**的行业|
|缺点|授权管理不方便，**灵活性不高**；**片面**强调**保密性/完整性**|

### RBAC

传统的访问控制中，主要针对用户个人授予权限，但随着用户大量增加，很难实现系统的层次化分权管理。

在用户和访问权限之间引入角色概念，user的工作职责基于角色，不同user可具有相同角色，统一用户可具有多种角色

RBAC既具有身份策略，也具有规则策略的特征

**基于角色的访问控制（Role-Based Access Control，RBAC）**是一种广泛使用的访问控制方法，它通过将用户分配到不同的角色，并为每个角色定义访问权限，从而实现对系统资源的访问控制。RBAC的核心思想是将访问控制与用户的具体身份解耦，而是基于用户在组织中的角色来管理权限。这种方法简化了权限管理，提高了系统的可维护性和可扩展性。

#### RBAC的基本概念

##### 1. **角色（Role）**
角色是RBAC中的核心概念，它代表了用户在系统中的职责或职位。每个角色都有一组与之关联的权限，这些权限定义了角色可以访问的资源和可以执行的操作。

**例子**：
- **管理员（Admin）**：可以访问和修改系统的所有资源。
- **普通用户（User）**：只能访问特定的资源，如个人文件和公共文件。
- **审计员（Auditor）**：可以查看系统日志和审计报告，但不能修改系统配置。

###### 2. **用户（User）**
用户是系统中的实际使用者。每个用户可以被分配一个或多个角色。用户通过其分配的角色获得相应的权限。

**例子**：
- 用户Alice被分配了“普通用户”和“审计员”两个角色。
- 用户Bob被分配了“管理员”角色。

##### 3. **权限（Permission）**
权限定义了用户可以对特定资源执行的操作。权限通常以资源和操作的组合形式表示。

**例子**：
- **读取文件（Read File）**
- **写入文件（Write File）**
- **删除文件（Delete File）**
- **查看日志（View Log）**

#### RBAC的工作原理

1. **角色分配**：
   - 系统管理员根据用户的职责将用户分配到相应的角色。一个用户可以被分配多个角色，以满足其在系统中的不同职责。

2. **权限分配**：
   - 系统管理员为每个角色定义一组权限。这些权限定义了角色可以访问的资源和可以执行的操作。

3. **访问控制**：
   - 当用户请求访问某个资源或执行某个操作时，系统会检查用户分配的角色，并根据角色的权限来决定是否允许该操作。

#### RBAC的优势

1. **简化权限管理**：
   - 通过将权限与角色关联，而不是直接与用户关联，RBAC简化了权限管理。管理员只需管理角色的权限，而不是每个用户的权限。

2. **提高安全性**：
   - RBAC通过严格的权限分配和角色隔离，减少了用户滥用权限的风险。每个用户只能访问其职责范围内的资源。

3. **提高可维护性和可扩展性**：
   - RBAC模型易于维护和扩展。当系统需求变化时，管理员只需调整角色的权限，而不需要重新配置每个用户的权限。

4. **符合组织结构**：
   - RBAC模型与组织的职责结构相匹配，易于理解和实施。它支持组织中的职责分离原则，确保不同职责的用户不会相互干扰。

### RBAC的实施步骤

1. **需求分析**：
   - 分析组织的业务需求，确定需要哪些角色和权限。

2. **角色定义**：
   - 定义系统中的角色，并为每个角色分配相应的权限。

3. **用户分配**：
   - 根据用户的职责，将用户分配到相应的角色。

4. **权限管理**：
   - 定期审查和调整角色的权限，确保权限分配符合组织的安全策略。

5. **审计和监控**：
   - 定期审计角色的权限和用户的活动，确保系统安全。

### RBAC的限制

1. **角色爆炸问题**：
   - 如果角色定义过于细致，可能会导致角色数量过多，增加管理复杂性。

2. **灵活性有限**：
   - RBAC模型相对固定，对于一些复杂的访问控制需求，可能需要结合其他访问控制模型（如ABAC）来实现。

3. **权限过度集中**：
   - 如果某些角色的权限过于集中，可能会导致安全风险。需要通过职责分离等措施来缓解这一问题。

#### 总结

**RBAC（基于角色的访问控制）**是一种有效的访问控制方法，通过将用户分配到不同的角色，并为每个角色定义访问权限，简化了权限管理，提高了系统的可维护性和可扩展性。RBAC广泛应用于各种信息系统中，特别是在对安全要求较高的场景中，如企业资源规划（ERP）系统、医疗信息系统等。通过合理设计和实施RBAC模型，可以有效提高系统的安全性和管理效率。

### 访问控制的基本原则

1. 最小特权原则

2. 多人负责原则

3. 最小泄露原则

4. 多级安全策略

#### 1. 最小特权原则（Principle of Least Privilege）

**定义**：最小特权原则要求每个用户或进程仅被授予完成其任务所必需的最小权限集合。这意味着用户或进程不会被授予超出其职责范围的任何额外权限。

**目的**：

- **减少风险**：通过限制用户的权限，即使用户账户被攻击者利用，攻击者能够造成的损害也会被限制在最小范围内。

- **防止滥用**：减少用户因疏忽或恶意行为导致的安全问题。

**例子**：

- 在一个企业环境中，普通员工可能只需要访问其工作相关的文件和应用程序，而不需要访问整个公司的财务系统。因此，普通员工的账户权限应限制在仅能访问其工作所需的资源。

- 系统管理员可能需要更广泛的权限来管理整个系统，但这些权限应严格限制在必要的范围内，并且应有严格的审计和监控机制。

#### 2. 多人负责原则（Principle of Separation of Duties）

**定义**：多人负责原则要求将关键任务或敏感操作分配给多个用户，确保没有单一用户可以独立完成所有操作。这样可以防止任何单一用户滥用权力或犯错误。

**目的**：

- **防止滥用**：通过将任务分配给多个用户，确保没有单一用户可以独立完成所有操作，从而减少滥用权力的风险。

- **增加透明度**：多人负责可以增加操作的透明度，便于审计和监控。

**例子**：

- 在财务系统中，支付操作可能需要两个或更多用户的批准。例如，一个用户可以发起支付请求，但另一个用户必须批准该请求才能完成支付。

- 在软件开发环境中，代码提交可能需要经过代码审查，确保代码质量并防止恶意代码的注入。

#### 3. 最小泄露原则（Principle of Least Disclosure）

**定义**：最小泄露原则要求系统仅向用户或进程提供完成其任务所必需的信息，避免提供额外的敏感信息。这有助于减少信息泄露的风险。

**目的**：

- **减少信息泄露**：通过限制用户或进程获取的信息量，减少敏感信息泄露的可能性。

- **保护隐私**：确保用户或进程只能访问其需要的信息，保护其他用户的隐私和敏感数据。

**例子**：

- 在一个医疗信息系统中，医生可能只需要访问与其患者相关的医疗记录，而不需要访问其他患者的记录。因此，系统应限制医生只能访问其负责的患者记录。

- 在一个企业环境中，员工可能只需要访问与其工作相关的文件，而不需要访问整个公司的文件系统。因此，系统应限制员工只能访问其工作所需的文件。

#### 4. 多级安全策略（Multilevel Security Policy）

**定义**：多级安全策略是一种访问控制策略，将系统资源和用户分为不同的安全级别。每个安全级别都有其特定的访问权限和限制，确保高安全级别的资源只能由具有相应权限的用户访问。

**目的**：

- **保护敏感信息**：通过将资源和用户分为不同的安全级别，确保敏感信息只能由授权用户访问，从而保护信息的安全性和保密性。

- **防止信息泄露**：通过严格的访问控制，防止低安全级别的用户访问高安全级别的资源，减少信息泄露的风险。

**例子**：

- 在军事系统中，信息可能被分为不同的安全级别，如“机密”、“绝密”和“最高机密”。只有具有相应安全级别的用户才能访问特定级别的信息。

- 在企业环境中，敏感文件可能被标记为高安全级别，只有具有高安全级别的用户才能访问。例如，财务报告可能被标记为高安全级别，只有财务部门的高级管理人员才能访问。
